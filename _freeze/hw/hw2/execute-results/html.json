{
  "hash": "12b026789796d00b5ddf86248d29ab14",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Homework 2: Data Visualization and Data Wrangling\"\nsubtitle: \"Spring 2024 MATH/COSC 3570 Introduction to Data Science by Dr. Cheng-Han Yu\"\nformat: \n  html:\n    toc: true\n    code-fold: false\n    code-tools: true\ndate: today\nauthor: \"**Insert Your Name!!**\"\nnumber-sections: true\nfrom: markdown+emoji\neditor: \n  source\n---\n\n\n\n\n# Data Wrangling and Tidying\n\n## Murders {#sec-murders}\n\n1. Import the data set `murders`. Use the pipe operator `|>` and the **dplyr** functions `mutate()`, `filter()`, and `select()` to get the following data output. Call the data set `df`. \n\nThe filtering conditions are \n\n+ `region` in \"Northeast\" or \"West\"\n+ `rate = total / population * 100000` is less than 1. \n  \nThe new variable `rank` is based on `rate`. The highest rate is ranked 1st. **[Hint:]** Use the function `rank()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## code\n\n# # A tibble: 8 × 4\n#    rate  rank state         total\n#   <dbl> <dbl> <chr>         <dbl>\n# 1 0.515    49 Hawaii            7\n# 2 0.766    46 Idaho            12\n# 3 0.828    44 Maine            11\n# 4 0.380    50 New Hampshire     5\n# 5 0.940    42 Oregon           36\n# 6 0.796    45 Utah             22\n# 7 0.320    51 Vermont           2\n# 8 0.887    43 Wyoming           5\n```\n:::\n\n\n\n2. Change the type of column `rank` to *factor*, and `total` to *integer*. (You can use the built-in `as.factor()` and `as.integer()` or the `convert()` function in the [**hablar**](https://cran.r-project.org/web/packages/hablar/vignettes/convert.html) package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## code\n```\n:::\n\n\n\n\n3. Create a list named `df_lst` of two elements. The first element is a subset of `df` whose rows have `total` less than 10, and the second element is a subset of `df` so that each of its row has `total` higher than 10. Print it out.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## code\n\n\n# [[1]]\n# # A tibble: 4 × 4\n#    rate rank  state         total\n#   <dbl> <fct> <chr>         <dbl>\n# 1 0.515 49    Hawaii            7\n# 2 0.380 50    New Hampshire     5\n# 3 0.320 51    Vermont           2\n# 4 0.887 43    Wyoming           5\n# \n# [[2]]\n# # A tibble: 4 × 4\n#    rate rank  state  total\n#   <dbl> <fct> <chr>  <dbl>\n# 1 0.766 46    Idaho     12\n# 2 0.828 44    Maine     11\n# 3 0.940 42    Oregon    36\n# 4 0.796 45    Utah      22\n```\n:::\n\n\n\n4. Combine the two data sets in `df_lst` using `rbind()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## code\n```\n:::\n\n\n\n\n5. The **dplyr** provides `dplyr::bind_rows()` and  `dplyr::bind_cols()` that are analogs to `rbind()` and `cbind()` in the R **base**. Combine the two data sets in `df_lst` using `bind_rows()`. The result should be exactly the same as the previous one.\n\n::: {.cell}\n\n```{.r .cell-code}\n## code\n```\n:::\n\n\n\n6. Combine the two data frames `data1` and `data2` below using `bind_rows()` and `rbind()`. Describe what happened and their difference. (Note that the two data sets have different column names)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata1 <- tibble(x = letters[1:5])\ndata2 <- tibble(y = 1:3)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## code (Error may happen. set eval: false if you'd like to render the document.)\n```\n:::\n\n\n\n7. With `df`, select `state` and `total`, and arrange `df` by `total` in an increasing order.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## code\n```\n:::\n\n\n\n8. With `df`, use `contains()` to select column variables whose name contains the string *\"at\"*. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n## code\n```\n:::\n\n\n9. Back to `murders`. Extract the rows whose has the largest population in its region as the shown output. The population is ranked in a decreasing order.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## code\n\n# # A tibble: 4 × 5\n#   state      abb   region        population total\n#   <chr>      <chr> <chr>              <dbl> <dbl>\n# 1 California CA    West            37253956  1257\n# 2 Texas      TX    South           25145561   805\n# 3 New York   NY    Northeast       19378102   517\n# 4 Illinois   IL    North Central   12830632   364\n```\n:::\n\n\n\n\n## Baseball {#sec-baseball}\n\n1. Install and load the [**Lahman**](https://github.com/cdalzell/Lahman) library. This database includes data related to baseball teams. It includes summary statistics about how the players performed on offense and defense for several years. It also includes personal information about the players. The `Batting` data frame contains the offensive statistics for all players for many years:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 112,184\nColumns: 22\n$ playerID <chr> \"abercda01\", \"addybo01\", \"allisar01\", \"allisdo01\", \"ansonca01…\n$ yearID   <int> 1871, 1871, 1871, 1871, 1871, 1871, 1871, 1871, 1871, 1871, 1…\n$ stint    <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n$ teamID   <fct> TRO, RC1, CL1, WS3, RC1, FW1, RC1, BS1, FW1, BS1, CL1, CL1, W…\n$ lgID     <fct> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ G        <int> 1, 25, 29, 27, 25, 12, 1, 31, 1, 18, 22, 1, 10, 3, 20, 29, 1,…\n$ AB       <int> 4, 118, 137, 133, 120, 49, 4, 157, 5, 86, 89, 3, 36, 15, 94, …\n$ R        <int> 0, 30, 28, 28, 29, 9, 0, 66, 1, 13, 18, 0, 6, 7, 24, 26, 0, 0…\n$ H        <int> 0, 32, 40, 44, 39, 11, 1, 63, 1, 13, 27, 0, 7, 6, 33, 32, 0, …\n$ X2B      <int> 0, 6, 4, 10, 11, 2, 0, 10, 1, 2, 1, 0, 0, 0, 9, 3, 0, 0, 1, 0…\n$ X3B      <int> 0, 0, 5, 2, 3, 1, 0, 9, 0, 1, 10, 0, 0, 0, 1, 3, 0, 0, 1, 0, …\n$ HR       <int> 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0…\n$ RBI      <int> 0, 13, 19, 27, 16, 5, 2, 34, 1, 11, 18, 0, 1, 5, 21, 23, 0, 0…\n$ SB       <int> 0, 8, 3, 1, 6, 0, 0, 11, 0, 1, 0, 0, 2, 2, 4, 4, 0, 0, 3, 0, …\n$ CS       <int> 0, 1, 1, 1, 2, 1, 0, 6, 0, 0, 1, 0, 0, 0, 0, 4, 0, 0, 1, 0, 0…\n$ BB       <int> 0, 4, 2, 0, 2, 0, 1, 13, 0, 0, 3, 1, 2, 0, 2, 9, 0, 0, 4, 1, …\n$ SO       <int> 0, 0, 5, 2, 1, 1, 0, 1, 0, 0, 4, 0, 0, 0, 2, 2, 3, 0, 2, 0, 2…\n$ IBB      <int> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ HBP      <int> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ SH       <int> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ SF       <int> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ GIDP     <int> 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 2, 0, 1, 2, 0, 0, 0, 0, 3…\n```\n\n\n:::\n:::\n\n\nUse `Batting` data to obtain the top 10 player observations that hit the most home runs (in descending order) in 2022. Call the data set `top10`, make it as a tibble and print it out.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## code\n```\n:::\n\n\n\n2. But who are these players? In the `top10` data, we see an ID, but not the names. The player names are in the `People` data set:\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 20,676\nColumns: 26\n$ playerID     <chr> \"aardsda01\", \"aaronha01\", \"aaronto01\", \"aasedo01\", \"abada…\n$ birthYear    <int> 1981, 1934, 1939, 1954, 1972, 1985, 1850, 1877, 1869, 186…\n$ birthMonth   <int> 12, 2, 8, 9, 8, 12, 11, 4, 11, 10, 9, 3, 10, 2, 8, 9, 6, …\n$ birthDay     <int> 27, 5, 5, 8, 25, 17, 4, 15, 11, 14, 20, 16, 22, 16, 17, 1…\n$ birthCountry <chr> \"USA\", \"USA\", \"USA\", \"USA\", \"USA\", \"D.R.\", \"USA\", \"USA\", …\n$ birthState   <chr> \"CO\", \"AL\", \"AL\", \"CA\", \"FL\", \"La Romana\", \"PA\", \"PA\", \"V…\n$ birthCity    <chr> \"Denver\", \"Mobile\", \"Mobile\", \"Orange\", \"Palm Beach\", \"La…\n$ deathYear    <int> NA, 2021, 1984, NA, NA, NA, 1905, 1957, 1962, 1926, NA, 1…\n$ deathMonth   <int> NA, 1, 8, NA, NA, NA, 5, 1, 6, 4, NA, 2, 6, NA, NA, NA, N…\n$ deathDay     <int> NA, 22, 16, NA, NA, NA, 17, 6, 11, 27, NA, 13, 11, NA, NA…\n$ deathCountry <chr> NA, \"USA\", \"USA\", NA, NA, NA, \"USA\", \"USA\", \"USA\", \"USA\",…\n$ deathState   <chr> NA, \"GA\", \"GA\", NA, NA, NA, \"NJ\", \"FL\", \"VT\", \"CA\", NA, \"…\n$ deathCity    <chr> NA, \"Atlanta\", \"Atlanta\", NA, NA, NA, \"Pemberton\", \"Fort …\n$ nameFirst    <chr> \"David\", \"Hank\", \"Tommie\", \"Don\", \"Andy\", \"Fernando\", \"Jo…\n$ nameLast     <chr> \"Aardsma\", \"Aaron\", \"Aaron\", \"Aase\", \"Abad\", \"Abad\", \"Aba…\n$ nameGiven    <chr> \"David Allan\", \"Henry Louis\", \"Tommie Lee\", \"Donald Willi…\n$ weight       <int> 215, 180, 190, 190, 184, 235, 192, 170, 175, 169, 220, 19…\n$ height       <int> 75, 72, 75, 75, 73, 74, 72, 71, 71, 68, 74, 71, 70, 78, 7…\n$ bats         <fct> R, R, R, R, L, L, R, R, R, L, R, R, R, R, R, L, R, L, L, …\n$ throws       <fct> R, R, R, R, L, L, R, R, R, L, R, R, R, R, L, L, R, L, R, …\n$ debut        <chr> \"2004-04-06\", \"1954-04-13\", \"1962-04-10\", \"1977-07-26\", \"…\n$ finalGame    <chr> \"2015-08-23\", \"1976-10-03\", \"1971-09-26\", \"1990-10-03\", \"…\n$ retroID      <chr> \"aardd001\", \"aaroh101\", \"aarot101\", \"aased001\", \"abada001…\n$ bbrefID      <chr> \"aardsda01\", \"aaronha01\", \"aaronto01\", \"aasedo01\", \"abada…\n$ deathDate    <date> NA, 2021-01-22, 1984-08-16, NA, NA, NA, 1905-05-17, 1957…\n$ birthDate    <date> 1981-12-27, 1934-02-05, 1939-08-05, 1954-09-08, 1972-08-…\n```\n\n\n:::\n:::\n\n\nWe can see column names `nameFirst` and `nameLast`. Use the `left_join()` function to create a table of the top home run hitters. The data table should have variables *playerID*, *nameFirst*, *nameLast*, and *HR*. Overwrite the object `top10` with this new table, and print it out.\n\n::: {.cell}\n\n```{.r .cell-code}\n## code\n```\n:::\n\n\n\n3. Use the `Fielding` data frame to add each player's position to the table you created in (2). Make sure that you filter for the year 2022 first, then use `right_join()`. This time show *nameFirst*, *nameLast*, *teamID*, *HR*, and *POS*.\n\n::: {.cell}\n\n```{.r .cell-code}\n## code\n```\n:::\n\n\n\n\n## Pivoting\n\n1. The R built-in `co2` data set is not tidy. Let's make it tidy. Run the following code to define the `co2_wide` object:\n\n::: {.cell}\n\n```{.r .cell-code}\nco2_wide <- data.frame(matrix(co2, ncol = 12, byrow = TRUE)) |> \n    setNames(1:12) |> \n    mutate(year = as.character(1959:1997))\n```\n:::\n\nUse the `pivot_longer()` function to make it tidy. Call the column with the CO2 measurements `co2` and call the month column `month`. Call the resulting object `co2_tidy`. Print it out.\n\n::: {.cell}\n\n```{.r .cell-code}\n## code\n\n\n## # A tibble: 468 x 3\n##    year  month   co2\n##    <chr> <chr> <dbl>\n##  1 1959  1      315.\n##  2 1959  2      316.\n##  3 1959  3      316.\n##  4 1959  4      318.\n##  5 1959  5      318.\n##  6 1959  6      318 \n##  7 1959  7      316.\n##  8 1959  8      315.\n##  9 1959  9      314.\n## 10 1959  10     313.\n## # … with 458 more rows\n```\n:::\n\n\n\n## Data Manipulation in Python\n\n<!-- Here we redo some problems in @sec-murders using Python. -->\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport numpy as np\nimport pandas as pd\n```\n:::\n\n\n\n1. Use Python to do @sec-murders question 1. \n    \n\n::: {.cell}\n\n```{.python .cell-code}\n\n## code\n```\n:::\n\n\n\n\n2. Use Python to do @sec-murders question 7. \n\n\n\n::: {.cell}\n\n```{.python .cell-code}\n\n## code\n```\n:::\n\n\n\n3. Use Python to do @sec-murders question 9. **[Hint:]** The method [pandas.DataFrame.drop_duplicates()]( https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.drop_duplicates.html) is analogous to `dplyr::distinct()`. Please figure out what we should use in the argument subset and keep.\n\n\n::: {.cell}\n\n```{.python .cell-code}\n## code\n\n```\n:::\n\n\n\n4. Use Python to do @sec-baseball question 1. (Import the data [Batting.csv](./Batting.csv)).\n\n\n::: {.cell}\n\n```{.python .cell-code}\n## code\n\n```\n:::\n\n\n\n5. Use Python to do @sec-baseball question 2. (Import the data [People.csv](./People.csv)).\n\n\n::: {.cell}\n\n```{.python .cell-code}\n## code\n\n```\n:::\n\n\n\n# Data Visualization\n\nIn this section all the plots should be generated using **ggplot2**.\n\n\n\n## murders\n\nUse `murders` to make plots.\n\n\n1. Create a scatter plot of total murders (x-axis) versus population sizes (y-axis) using the pipe operator `|>` that the murders data set is on the left to `|>`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## code\n```\n:::\n\n\n\n2. Generate the plot below using `label` and `color` aesthetics in `aes()` and a geometry layer `geom_label()`. Save the ggplot object as `p`. Here, we add abbreviation as the label, and make the labels' color be determined by the state's region.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## code\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](./img/murder_label.png){width=656}\n:::\n:::\n\n\n\n\n3. Use the object `p` in (2) and \n\n  + Change both axes to be in the $\\log_{10}$ scale using [`scale_x_log10()`](https://ggplot2.tidyverse.org/reference/scale_continuous.html) and `scale_y_log10()`\n  + Add a title \"Gun murder data\"\n  + Use the wall street journal theme in [**ggthemes**](https://yutannihilation.github.io/allYourFigureAreBelongToUs/ggthemes/).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## code\n```\n:::\n\n\n\n\n\n## mpg\n\nUse `mpg` to make plots.\n\n1. What's gone wrong with this code? Why are the points not blue? Change it so that the points are colored in blue.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpg |> ggplot(mapping = aes(x = displ, y = hwy, colour = \"blue\")) +\n    geom_point()\n```\n\n::: {.cell-output-display}\n![](hw2_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\n\n2. Generate the bar chart below. \n\n::: {.cell}\n\n```{.r .cell-code}\n## code\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](./img/mpg_bar.png){width=662}\n:::\n:::\n\n\n\n\n3. Complete the code to generate the boxplot below. Note that `x = class` and `y = hwy`, so the coordinates need to be flipped.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## code\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](./img/mpg_boxplot.png){width=665}\n:::\n:::\n\n\n\n4. Generate the histogram below with *density* scale. Map `y` to the internal variable `..density..` (`after_stat(density)`) to show density values. Put the legend inside the plot at `c(0.9, 0.15)`. (check ?theme help page)\n\n::: {.cell}\n\n```{.r .cell-code}\n## code\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](./img/mpg_hist.png){width=664}\n:::\n:::\n\n\n\n\n5. Generate the scatter plot below. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n## code\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](./img/mpg_text.png){width=670}\n:::\n:::\n",
    "supporting": [
      "hw2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}